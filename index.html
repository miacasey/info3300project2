<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>

  <!-- scatterplot -->
  <svg id = "scatter" width = 850 height = 550 style = "border: 1px solid black">
  </svg>

  <script>
  const requestData = async() => {

    const may2018 = await d3.csv("/May2018.csv");
    const jan2018 = await d3.csv("/Jan2018.csv");
    const aug2016 = await d3.csv("/August2016.csv");
    const july2015 = await d3.csv("/July2015.csv");
    const jan2014 = await d3.csv("/2014.csv");



    //scatterplot data processing
    let data = [jan2014, july2015, aug2016, jan2018, may2018];

    function dataProcessing(company){

      let dataObject = {
        female: [],
        male: [],
        white: [],
        asian: [],
        latino: [],
        black: []
      };

      for (let i = 0; i < data.length; i++){
        let lineNum = 0;
        for (let j = 0; j < data[i].length; j++){
          if (data[i][j].Company === company){
            lineNum = j;
          }
        }

        dataObject.female.push(data[i][lineNum].Female.replace(/[^.\d]/g, ""));
        dataObject.male.push(data[i][lineNum].Male.replace(/[^.\d]/g, ""));
        dataObject.white.push(data[i][lineNum].White.replace(/[^.\d]/g, ""));
        dataObject.asian.push(data[i][lineNum].Asian.replace(/[^.\d]/g, ""));
        dataObject.latino.push(data[i][lineNum].Latino.replace(/[^.\d]/g, ""));
        dataObject.black.push(data[i][lineNum].Black.replace(/[^.\d]/g, ""));

      }

      return dataObject;

    }

    let usPopulation = dataProcessing("U.S. Population");
    let sampleAvg = dataProcessing("average from our sample");
    let diversityInc = dataProcessing("DiversityInc top 50");
    let fortune500 = dataProcessing("Fortune 500 CEOs");
    let congress = dataProcessing("US Congress");

    //scales
    let xScale = d3.scaleLinear()
                   .domain([0, 4])
                   .range([0, 800]);

    let yScale = d3.scaleLinear()
                   .domain([0, 100])
                   .range([500, 0]);

    //grid
    let svg = d3.select("svg#scatter");

    let leftAxis = d3.axisLeft(yScale);
    svg.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate(25, 10)")
      .call(leftAxis);
    //x-axis grids
    for (let i = 0; i < 5; i++){
      svg.append('line')
         .attr('x1', xScale(i))
	       .attr('x2', xScale(i))
	       .attr('y1', 500)
         .attr('y2', 0)
         .style('stroke', 'black')
         .attr("transform", "translate(25, 10)");

      svg.append("text")
         .attr("x", xScale(i))
         .attr("y", 500)
         .text(i + 2014)
         .style('color', 'black')
         .attr("transform", "translate(10, 30)");
    }

    //y-axis grids
    for (let j = 0; j <= 100; j+=10){
      svg.append('line')
         .attr('x1', 0)
         .attr('x2', 800)
         .attr('y1', yScale(j))
         .attr('y2', yScale(j))
         .style('stroke', 'black')
         .attr("transform", "translate(25, 10)");
    }


  }

  requestData();
  </script>


</body>
</html>
